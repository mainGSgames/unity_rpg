<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836" data-dLayer-ignore="true" data-document-language="true"></script><script type="text/javascript">function OptanonWrapper() {}</script><script>window.dataLayer = window.dataLayer || []; dataLayer.push({ event: 'dataLayer-initialized', user: { user_unity_id: undefined, user_logged_in: 'no' }, environment: { environment_locale: 'en-us', environment_currency: undefined }});</script><script>var offline=(location.href.indexOf('docs.unity3d.com')==-1)?true:false;if(!offline){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');}</script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual: Optimizing arrays</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<meta property="relative-path-to-manual" content="">
<meta property="version-switcher-versions-with-this-page" content="Versions with this page:">
<meta property="version-switcher-versions-without-this-page" content="Versions without this page:">
<meta property="version-switcher-supported" content="Supported">
<meta property="version-switcher-legacy" content="Legacy">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<link rel="canonical" href="https://docs.unity3d.com/6000.2/Documentation/Manual/performance-optimizing-arrays.html">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="/StaticFilesConfig/UnityVersionsInfo.js"></script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=20250905"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=20250905"></script><script type="text/javascript" src="../StaticFilesManual/js/image-comp.js?ts=20250905"></script><script type="text/javascript" src="docdata/toc.js?ts=20250905"></script><script type="text/javascript" src="docdata/global_toc.js?ts=20250905"></script><link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=20250905">
<link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/icons.css?ts=20250905">
<link rel="stylesheet" href="../StaticFilesManual/css/prism.css">
<script src="../StaticFilesManual/js/prism.js"></script><script src="/StaticFilesConfig/feedback/feedback.js"></script><script src="../StaticFilesManual/js/jquery.sidebar.min.js"></script><link rel="stylesheet" href="../StaticFilesManual/css/mobileoptimisation.css">
<script src="../StaticFilesManual/js/mobileoptimisation.js"></script>
</head>
<body>
<div id="DocsAnalyticsData" data-area="none" data-pagetype="manual"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a aria-label="go to the homepage" href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" aria-label="Search manual documentation" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity.com/">unity.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="toggle version-number" id="VersionNumber" data-target=".otherversionscontent">
                                Version: <b>Unity 6.2</b> (6000.2)
                                <div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">
<ul id="OtherVersionsContentUl"></ul>
<div id="otherVersionsLegend"><ul>
<li>
<div id="supportedColour" class="legendBox"></div>Supported</li>
<li>
<div id="notFoundColour" class="legendBox"></div>Legacy</li>
</ul></div>
</div>
<div id="VersionSwitcherArrow" class="arrow versionSwitcherArrow"></div>
</div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/performance-optimizing-arrays.html">English</a></li>
<li><a href="/cn/current/Manual/performance-optimizing-arrays.html">中文</a></li>
<li><a href="/ja/current/Manual/performance-optimizing-arrays.html">日本語</a></li>
<li><a href="/kr/current/Manual/performance-optimizing-arrays.html">한국어</a></li>
</ul></div>
</div></div>
</div></div>
<div class="mobileLogo"><a aria-label="go to the homepage" href="https://docs.unity3d.com"></a></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc" id="customScrollbar">
<h2>Unity Manual</h2>
<div class="search-form sidebar-search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" aria-label="Search manual documentation" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" id="mobileSearchBtn" class="submit" value="Search">
</form></div>
<div class="toggle version-number sidebar-version-switcher" id="VersionNumber" data-target=".otherversionscontent"><form id="otherVersionsContentMobileForm"><div class="ui-field-contain">
<label for="select-native-4">Version: Unity 6.2</label><select name="select-native-4" id="versionsSelectMobile"><option>Select a different version</option>
<optgroup id="versionsWithThisPageMobile" label="Versions with this page"></optgroup>
<optgroup id="versionsWithoutThisPageMobile" label="Versions without this page"></optgroup></select>
</div></form></div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/performance-optimizing-arrays.html">English</a></li>
<li><a href="/cn/current/Manual/performance-optimizing-arrays.html">中文</a></li>
<li><a href="/ja/current/Manual/performance-optimizing-arrays.html">日本語</a></li>
<li><a href="/kr/current/Manual/performance-optimizing-arrays.html">한국어</a></li>
</ul></div>
</div></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="scripting.html">Programming in Unity</a></li>
<li><a href="scripting-optimization.html">Code optimization</a></li>
<li><a href="performance-optimizing-code-managed-memory.html">Optimizing your code for managed memory</a></li>
<li>Optimizing arrays</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a aria-label="go to the previous page" href="performance-reusable-code.html"></a></span><div class="tip">Using coding patterns with reusable memory </div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a aria-label="go to the next page" href="test-framework/test-framework-introduction.html"></a></span><div class="tip">Testing your code</div>
</div>
</div></div>
<div id="_leavefeedback"></div>
<h1>Optimizing arrays</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>The following page outlines examples to improve the performance of your code when using <a href="https://learn.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/arrays">arrays</a>.</p>

<h2>Pass arrays as parameters to methods</h2>

<p>Sometimes it might be convenient to write a method that creates a new array, fills the array with values and then returns it. However, if this method is called repeatedly, then new memory gets allocated each time. </p>

<p>The following example code shows an example of a method which creates an array every time it’s called:</p>

<pre><code class="lang-cs">// Bad C# script example: Every time the RandomList method is called it
// allocates a new array
using UnityEngine;
using System.Collections;

public class ExampleScript : MonoBehaviour {
    float[] RandomList(int numElements) {
        var result = new float[numElements];
        
        for (int i = 0; i &lt; numElements; i++) {
            result[i] = Random.value;
        }
        
        return result;
    }
}
</code></pre>

<p>One way you can avoid allocating memory every time is to make use of the fact that an array is a reference type. You can modify an array that’s passed into a method as a parameter, and the results remain after the method returns. To do this, you can configure the example code as follows:</p>

<pre><code class="lang-cs">// Good C# script example: This version of method is passed an array to fill
// with random values. The array can be cached and re-used to avoid repeated
// temporary allocations
using UnityEngine;
using System.Collections;

public class ExampleScript : MonoBehaviour {
    void RandomList(float[] arrayToFill) {
        for (int i = 0; i &lt; arrayToFill.Length; i++) {
            arrayToFill[i] = Random.value;
        }
    }
}
</code></pre>

<p>This code replaces the existing contents of the array with new values. This workflow requires the calling code to do the initial allocation of the array, but the function doesn’t generate any new garbage when it’s called. The array can then be re-used and re-filled with random numbers the next time this method is called without any new allocations on the managed heap.</p>

<h2>Avoid repeated access to array-valued Unity APIs</h2>

<p>One cause of unintended allocations on arrays is the repeated accessing of Unity APIs that return arrays. All Unity APIs that return arrays create a new copy of the array each time they’re accessed. If your code accesses an array-valued Unity API more often than necessary, it can affect the performance of your application.</p>

<p>As an example, the following code creates four copies of the vertices array per loop iteration. The allocations happen each time the <code>.vertices</code> property is accessed:</p>

<pre><code class="lang-cs">// Bad C# script example: this loop create 4 copies of the vertices array per iteration
void Update() {
    for(int i = 0; i &lt; mesh.vertices.Length; i++) {
        float x, y, z;

        x = mesh.vertices[i].x;
        y = mesh.vertices[i].y;
        z = mesh.vertices[i].z;

        // ...

        DoSomething(x, y, z);   
    }
}

</code></pre>

<p>You can refactor this code into a single array allocation, regardless of the number of loop iterations. To do this, configure your code to capture the vertices array before the loop:</p>

<pre><code class="lang-cs">// Better C# script example: create one copy of the vertices array
// and work with that
void Update() {
    var vertices = mesh.vertices;

    for(int i = 0; i &lt; vertices.Length; i++) {

        float x, y, z;

        x = vertices[i].x;
        y = vertices[i].y;
        z = vertices[i].z;

        // ...

        DoSomething(x, y, z);   
    }
}
</code></pre>

<p>An optimal way of doing this is to maintain a <code>List</code> of vertices which is cached and re-used between frames, and then use <a href="../ScriptReference/Mesh.GetVertices.html"><code>Mesh.GetVertices</code></a> to populate it when required.</p>

<pre><code class="lang-cs">// Best C# script example: create one copy of the vertices array
// and work with that.
List&lt;Vector3&gt; m_vertices = new List&lt;Vector3&gt;();

void Update() {
    mesh.GetVertices(m_vertices);

    for(int i = 0; i &lt; m_vertices.Length; i++) {

        float x, y, z;

        x = m_vertices[i].x;
        y = m_vertices[i].y;
        z = m_vertices[i].z;

        // ...

        DoSomething(x, y, z);   
    }
}
</code></pre>

<p>While the CPU performance implications of accessing a property that allocates an array once isn’t high, repeated accesses within tight loops create CPU performance hotspots. Repeated accesses expand the <a href="performance-managed-memory-introduction.html">managed heap</a>.</p>

<p>This problem is common on mobile devices, because the <a href="../ScriptReference/Input-touches.html"><code>Input.touches</code></a> API behaves similarly to the previous example. It’s also common for projects to contain code similar to the following, where an allocation occurs each time the <code>.touches</code> property is accessed:</p>

<pre><code class="lang-cs">// Bad C# script example: Input.touches returns an array every time it’s accessed
for ( int i = 0; i &lt; Input.touches.Length; i++ ) {
   Touch touch = Input.touches[i];

    // …
}
</code></pre>

<p>To improve this, you can configure your code to hoist the array allocation out of the loop condition:</p>

<pre><code class="lang-cs">// Better C# script example: Input.touches is only accessed once here
Touch[] touches = Input.touches;

for ( int i = 0; i &lt; touches.Length; i++ ) {

   Touch touch = touches[i];

   // …
}
</code></pre>

<p>The following code example converts the previous example to the allocation-free <code>Touch</code> API:</p>

<pre><code class="lang-cs">// BEST C# script example: Input.touchCount and Input.GetTouch don’t allocate at all.
int touchCount = Input.touchCount;

for ( int i = 0; i &lt; touchCount; i++ ) {
   Touch touch = Input.GetTouch(i);

   // …
}
</code></pre>

<p>
<strong>Note:</strong> The property access (<code>Input.touchCount</code>) remains outside the loop condition, to save the CPU impact of invoking the property’s get method.</p>

<h3>Alternative non-allocating APIs</h3>

<p>Some Unity APIs have alternative versions that don’t cause memory allocations. You should use these when possible. The following table contains an example of allocating APIs and their non-allocating alternatives:</p>

<table>
<colgroup>
<col style="text-align:left;">
<col style="text-align:left;">
</colgroup>

<thead>
<tr>
	<th style="text-align:left;"><strong>Allocating API</strong></th>
	<th style="text-align:left;"><strong>Non-allocating API alternative</strong></th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;"><a href="../ScriptReference/Physics.RaycastAll.html"><code>Physics.RaycastAll</code></a></td>
	<td style="text-align:left;"><a href="../ScriptReference/Physics.RaycastNonAlloc.html"><code>Physics.RaycastNonAlloc</code></a></td>
</tr>
<tr>
	<td style="text-align:left;"><a href="../ScriptReference/Animator-parameters.html"><code>Animator.parameters</code></a></td>
	<td style="text-align:left;">
<a href="../ScriptReference/Animator-parameterCount.html"><code>Animator.parameterCount</code></a> and <a href="../ScriptReference/Animator.GetParameter.html"><code>Animator.GetParameter</code></a>
</td>
</tr>
<tr>
	<td style="text-align:left;"><a href="../ScriptReference/Renderer-sharedMaterials.html"><code>Renderer.sharedMaterials</code></a></td>
	<td style="text-align:left;"><a href="../ScriptReference/Renderer.GetSharedMaterials.html"><code>Renderer.GetSharedMaterials</code></a></td>
</tr>
</tbody>
</table>

<p>In general, if the method returns an array, there’s usually a non-allocating version of the API which you can use to pass the array to.</p>

<h2>Use static instances of zero-length arrays</h2>

<p>Some development teams prefer to return empty arrays instead of <code>null</code> when an array-valued method needs to return an empty set. This coding pattern is common in a lot of managed languages, in particular with C# and Java.</p>

<p>When returning a zero-length array from a method, it’s more efficient to return a pre-allocated static instance of the zero-length array than to repeatedly create empty arrays. </p>

<h2>Use native arrays or other native containers for large arrays</h2>

<p>Unity’s <a href="performance-garbage-collector.html">garbage collector</a> is a heuristic garbage collector, which means that it treats any field that has the size of a pointer as if it is a pointer. The garbage collector checks every pointer and reference that it encounters.</p>

<p>When you use large arrays (with more than 10 thousand elements), the garbage collector might interpret large arrays as a long list of pointers that it needs to check, which increases memory pressure and slows the garbage collector down.</p>

<p>The scripting VM also has to allocate big chunks of managed heap space for large arrays which increases the chance that a random value looks like a valid address in the managed heap chunk’s memory address range. Large arrays are also a big contributing factor to managed heap fragmentation.</p>

<p>If you need to allocate arrays of such length, consider using the collection types in <code>Unity.Collections</code> namespace (including <a href="../ScriptReference/Unity.Collections.NativeArray_1.html"><code>NativeArray</code></a>) in the Unity core API, and the data structures in the <a href="https://docs.unity3d.com/Packages/com.unity.collections@latest">Unity Collections package</a>. As an additional benefit, using these collections are compatible with the <a href="job-system.html">job system</a> and Burst.</p>

<h2>Additional resources</h2>

<ul>
<li><a href="performance-managed-memory-introduction.html">Managed memory introduction</a></li>
<li><a href="performance-reference-types.html">Reference type management</a></li>
<li><a href="performance-reusable-code.html">Creating reusable code</a></li>
</ul>
<div id="_content"></div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a aria-label="go to the previous page" href="performance-reusable-code.html"></a></span><div class="tip">Using coding patterns with reusable memory </div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a aria-label="go to the next page" href="test-framework/test-framework-introduction.html"></a></span><div class="tip">Testing your code</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright ©2005-2025 Unity Technologies. All rights reserved. Built from 6000.2.5f1 (6de28e1118ee). Built on: 2025-09-05.</div>
<div class="menu">
<a href="https://learn.unity.com/">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a><a href="https://docs.unity3d.com/Manual/TermsOfUse.html">Terms of use</a><a href="https://unity.com/legal">Legal</a><a href="https://unity.com/legal/privacy-policy">Privacy Policy</a><a href="https://unity.com/legal/cookie-policy">Cookies</a><a href="https://unity.com/legal/do-not-sell-my-personal-information">Do Not Sell or Share My Personal Information</a><div id="ot-sdk-btn-container"><a id="ot-sdk-btn" class="ot-sdk-show-settings" href="javascript:void(0);">Your Privacy Choices (Cookie Settings)</a></div>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
